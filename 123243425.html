<!DOCTYPE html>
<html>

<head>
    <title>Demo</title>
</head>

<body>
    <h1>调用测试</h1>
    <p>test</p>
    <button onclick="getAccountInfo()">获取账户信息</button>
    <h2>返回结果:</h2>
    <pre id="result">等待调用...</pre>

    <script>
        // 创建imaFrame对象来接收回调
        window.imaFrame = {
            callbackFromNative: function (callbackId, result) {
                console.log('收到回调:', callbackId, result);
                document.getElementById('result').textContent = JSON.stringify(result, null, 2);
            }
        };

        function getAccountInfo() {
            try {
                if (window.imaJsBridge && window.imaJsBridge.invokeWithCallback) {
                    // 使用invokeWithCallback而不是invoke
                    var callbackId = 'callback_' + Date.now();
                    var requestData = JSON.stringify({
                        action: "getAccountInfo",
                        callbackId: callbackId,
                        args: "{}"
                    });

                    document.getElementById('result').textContent = '正在调用...';
                    window.imaJsBridge.invokeWithCallback(requestData);
                } else {
                    document.getElementById('result').textContent = 'imaJsBridge接口不可用';
                }
            } catch (error) {
                document.getElementById('result').textContent = '调用失败: ' + error.message;
            }
        }
    </script>
</body>

</html>
